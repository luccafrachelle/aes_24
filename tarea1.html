<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tarea 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tarea1_files/libs/clipboard/clipboard.min.js"></script>
<script src="tarea1_files/libs/quarto-html/quarto.js"></script>
<script src="tarea1_files/libs/quarto-html/popper.min.js"></script>
<script src="tarea1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tarea1_files/libs/quarto-html/anchor.min.js"></script>
<link href="tarea1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tarea1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tarea1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tarea1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tarea1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tarea 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ejercicio-1" class="level1">
<h1>Ejercicio 1</h1>
<section id="parte-1-argumentar-que-el-error-esperado-de-validación-es-el-mismo-para-m-observaciones-o-solo-1" class="level2">
<h2 class="anchored" data-anchor-id="parte-1-argumentar-que-el-error-esperado-de-validación-es-el-mismo-para-m-observaciones-o-solo-1">Parte 1: Argumentar que el error esperado de validación es el mismo para <span class="math inline">\(m\)</span> observaciones o solo 1</h2>
<p>Demostramos que el error esperado para <span class="math inline">\(m\)</span> observaciones es equivalente al error esperado para una observación usando la <strong>regla de esperanzas iteradas</strong>.</p>
<p>Ecuación de error esperado de validación: <span class="math display">\[
E\left[ \frac{1}{m} \sum_{i=1}^{m} (y'_i - \hat{\beta}^\top x'_i)^2 \right] = E\left[ (y'_1 - \hat{\beta}^\top x'_1)^2 \right]
\]</span></p>
<p>Aquí utilizamos la <strong>regla de esperanzas iteradas</strong>: <span class="math display">\[
E(Z) = E_t\left[ E_v(Z \mid t) \right]
\]</span> donde <span class="math inline">\(E_t\)</span> considera la aleatoriedad en la muestra de entrenamiento y <span class="math inline">\(E_v\)</span> en la de validación.</p>
<p><strong>Demostración:</strong></p>
<p>Dado que las observaciones del conjunto de validación <span class="math inline">\(\{(x'_i, y'_i)\}\)</span> son independientes e idénticamente distribuidas (i.i.d.), y que <span class="math inline">\(\hat{\beta}\)</span> está fijo dado el conjunto de entrenamiento, podemos escribir:</p>
<ol type="1">
<li><p>Calculamos el valor esperado del error de validación promedio: <span class="math display">\[
E\left[ \frac{1}{m} \sum_{i=1}^{m} (y'_i - \hat{\beta}^\top x'_i)^2 \right] = \frac{1}{m} \sum_{i=1}^{m} E\left[ (y'_i - \hat{\beta}^\top x'_i)^2 \right]
\]</span></p></li>
<li><p>Debido a la independencia y misma distribución de las observaciones, todos los términos en la suma son iguales: <span class="math display">\[
E\left[ (y'_i - \hat{\beta}^\top x'_i)^2 \right] = E\left[ (y'_1 - \hat{\beta}^\top x'_1)^2 \right], \quad \forall i
\]</span></p></li>
<li><p>Entonces, la suma se simplifica: <span class="math display">\[
\frac{1}{m} \sum_{i=1}^{m} E\left[ (y'_1 - \hat{\beta}^\top x'_1)^2 \right] = E\left[ (y'_1 - \hat{\beta}^\top x'_1)^2 \right]
\]</span></p></li>
</ol>
<p>Por lo tanto, el error esperado de validación para <span class="math inline">\(m\)</span> observaciones es igual al error esperado para una sola observación.</p>
</section>
<section id="parte-2-definición-de-las-variables-aleatorias-a-y-b" class="level2">
<h2 class="anchored" data-anchor-id="parte-2-definición-de-las-variables-aleatorias-a-y-b">Parte 2: Definición de las variables aleatorias <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span></h2>
<p>Definimos las variables <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> como: <span class="math display">\[
A = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{\beta}^\top x_i)^2
\]</span> <span class="math display">\[
B = \frac{1}{n} \sum_{i=1}^{n} (y'_i - \tilde{\beta}^\top x'_i)^2
\]</span></p>
<p>Argumentamos que <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> tienen la misma distribución, por lo tanto <span class="math inline">\(E(A) = E(B)\)</span>.</p>
<p><strong>Demostración:</strong></p>
<ol type="1">
<li><p>Ambos conjuntos de datos <span class="math inline">\(\{(x_i, y_i)\}\)</span> y <span class="math inline">\(\{(x'_i, y'_i)\}\)</span> son muestras independientes del mismo proceso generador de datos.</p></li>
<li><p>Los estimadores <span class="math inline">\(\hat{\beta}\)</span> y <span class="math inline">\(\tilde{\beta}\)</span> se obtienen ajustando el mismo modelo (por ejemplo, regresión lineal) a sus respectivos conjuntos de datos.</p></li>
<li><p>Debido a la simetría en el proceso y a que los datos son i.i.d., las distribuciones de <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> son idénticas.</p></li>
<li><p>Por lo tanto: <span class="math display">\[
E(A) = E(B)
\]</span></p></li>
</ol>
</section>
<section id="parte-3-relación-entre-b-y-el-error-de-validación" class="level2">
<h2 class="anchored" data-anchor-id="parte-3-relación-entre-b-y-el-error-de-validación">Parte 3: Relación entre <span class="math inline">\(B\)</span> y el error de validación</h2>
<p>Demostramos que <span class="math inline">\(B\)</span> es siempre menor o igual al error de validación utilizando la desigualdad: <span class="math display">\[
B = \frac{1}{n} \sum_{i=1}^{n} (y'_i - \tilde{\beta}^\top x'_i)^2 \leq \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2
\]</span></p>
<p><strong>Demostración:</strong></p>
<ol type="1">
<li><p>El estimador <span class="math inline">\(\tilde{\beta}\)</span> se obtiene minimizando el error cuadrático en el conjunto de validación: <span class="math display">\[
\tilde{\beta} = \arg\min_{\beta} \frac{1}{n} \sum_{i=1}^{n} (y'_i - \beta^\top x'_i)^2
\]</span></p></li>
<li><p>Por definición de mínimo, tenemos: <span class="math display">\[
\frac{1}{n} \sum_{i=1}^{n} (y'_i - \tilde{\beta}^\top x'_i)^2 \leq \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2
\]</span></p></li>
<li><p>Por lo tanto: <span class="math display">\[
B \leq \text{Error de validación con } \hat{\beta}
\]</span></p></li>
</ol>
</section>
<section id="parte-4-conclusión" class="level2">
<h2 class="anchored" data-anchor-id="parte-4-conclusión">Parte 4: Conclusión</h2>
<p>Usando el resultado anterior, concluimos que el error de entrenamiento es siempre menor o igual al error de validación: <span class="math display">\[
E\left[ \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{\beta}^\top x_i)^2 \right] \leq E\left[ \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2 \right]
\]</span></p>
<p><strong>Demostración:</strong></p>
<ol type="1">
<li><p>De la <strong>Parte 2</strong>, sabemos que <span class="math inline">\(E(A) = E(B)\)</span>.</p></li>
<li><p>De la <strong>Parte 3</strong>, tenemos que: <span class="math display">\[
B \leq \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2
\]</span></p></li>
<li><p>Tomando el valor esperado en ambos lados: <span class="math display">\[
E(B) \leq E\left[ \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2 \right]
\]</span></p></li>
<li><p>Sustituyendo <span class="math inline">\(E(A)\)</span> por <span class="math inline">\(E(B)\)</span>: <span class="math display">\[
E(A) \leq E\left[ \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2 \right]
\]</span></p></li>
<li><p>Es decir: <span class="math display">\[
E\left[ \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{\beta}^\top x_i)^2 \right] \leq E\left[ \frac{1}{n} \sum_{i=1}^{n} (y'_i - \hat{\beta}^\top x'_i)^2 \right]
\]</span></p></li>
</ol>
<p>Esto demuestra que, en promedio, el error de entrenamiento es menor o igual al error de validación, lo cual es coherente con el hecho de que el modelo está ajustado para minimizar el error en el conjunto de entrenamiento y puede no generalizar perfectamente al conjunto de validación.</p>
</section>
</section>
<section id="ejercicio-2" class="level1">
<h1>Ejercicio 2</h1>
<section id="a-el-tamaño-muestral-n-es-extremadamente-grande-y-el-número-de-predictores-p-es-pequeño" class="level2">
<h2 class="anchored" data-anchor-id="a-el-tamaño-muestral-n-es-extremadamente-grande-y-el-número-de-predictores-p-es-pequeño">a) El tamaño muestral <span class="math inline">\(n\)</span> es extremadamente grande y el número de predictores <span class="math inline">\(p\)</span> es pequeño</h2>
<p>Cuando el tamaño muestral <span class="math inline">\(n\)</span> es grande y el número de predictores <span class="math inline">\(p\)</span> es pequeño, generalmente esperamos que un método inflexible tenga mejor performance que un método flexible. Esto es porque un método inflexible, como la regresión lineal, puede capturar bien la verdadera relación entre los predictores y la respuesta cuando <span class="math inline">\(p\)</span> es pequeño. En este caso, agregar flexibilidad puede incrementar la varianza sin mejorar sustancialmente el sesgo.</p>
</section>
<section id="b-el-número-de-predictores-p-es-extremadamente-grande-y-el-número-de-observaciones-n-es-pequeño" class="level2">
<h2 class="anchored" data-anchor-id="b-el-número-de-predictores-p-es-extremadamente-grande-y-el-número-de-observaciones-n-es-pequeño">b) El número de predictores <span class="math inline">\(p\)</span> es extremadamente grande y el número de observaciones <span class="math inline">\(n\)</span> es pequeño</h2>
<p>Cuando <span class="math inline">\(p\)</span> es grande y <span class="math inline">\(n\)</span> es pequeño, un método flexible suele ser mejor. Esto se debe a que métodos flexibles pueden ajustarse mejor a los datos en situaciones donde hay muchos predictores, capturando relaciones complejas entre ellos y la respuesta. Sin embargo, también pueden sobreajustarse si <span class="math inline">\(n\)</span> es demasiado pequeño, lo que incrementaría el error por varianza.</p>
</section>
<section id="c-la-relación-entre-los-predictores-y-la-respuesta-es-marcadamente-no-lineal" class="level2">
<h2 class="anchored" data-anchor-id="c-la-relación-entre-los-predictores-y-la-respuesta-es-marcadamente-no-lineal">c) La relación entre los predictores y la respuesta es marcadamente no lineal</h2>
<p>Cuando la relación es no lineal, un método flexible puede capturar mejor esta no linealidad en comparación con un método inflexible. Métodos como los árboles de decisión o las redes neuronales pueden adaptarse mejor a patrones no lineales en los datos, mientras que un método inflexible puede no ser capaz de capturar estas relaciones.</p>
</section>
<section id="d-la-varianza-del-término-de-error-sigma2-vepsilon-es-extremadamente-alta" class="level2">
<h2 class="anchored" data-anchor-id="d-la-varianza-del-término-de-error-sigma2-vepsilon-es-extremadamente-alta">d) La varianza del término de error <span class="math inline">\(\sigma^2 = V(\epsilon)\)</span> es extremadamente alta</h2>
<p>Cuando la varianza del término de error es alta, un método inflexible es preferible porque los métodos flexibles tienden a sobreajustar el ruido en los datos. En situaciones donde hay mucho ruido, un método inflexible, que se centra más en la estructura general, suele ofrecer mejor performance al evitar capturar el ruido.</p>
</section>
</section>
<section id="ejercicio-3" class="level1">
<h1>Ejercicio 3</h1>
<section id="ventajas-y-desventajas-de-una-aproximación-flexible-vs-una-menos-flexible-en-regresión-o-clasificación" class="level2">
<h2 class="anchored" data-anchor-id="ventajas-y-desventajas-de-una-aproximación-flexible-vs-una-menos-flexible-en-regresión-o-clasificación">Ventajas y desventajas de una aproximación flexible vs una menos flexible en regresión o clasificación</h2>
<p>Una aproximación <strong>más flexible</strong> tiene las siguientes ventajas:</p>
<ul>
<li><p><strong>Captura mejor relaciones complejas</strong>: Los modelos flexibles pueden ajustarse a relaciones no lineales entre predictores y la variable respuesta, lo cual es útil cuando la verdadera relación no es simple.</p></li>
<li><p><strong>Menor sesgo</strong>: Debido a su capacidad de ajustarse mejor a los datos, los métodos flexibles tienden a tener menor sesgo que los métodos más simples o inflexibles.</p></li>
</ul>
<p>Sin embargo, también tienen las siguientes desventajas:</p>
<ul>
<li><p><strong>Mayor riesgo de sobreajuste</strong>: Un modelo flexible puede ajustarse demasiado bien a los datos de entrenamiento, capturando el ruido, lo que lleva a un peor desempeño en datos nuevos (alta varianza).</p></li>
<li><p><strong>Mayor complejidad</strong>: Los modelos flexibles tienden a ser más difíciles de interpretar y requieren mayor capacidad computacional.</p></li>
</ul>
<p>Por otro lado, una aproximación <strong>menos flexible</strong> tiene estas ventajas:</p>
<ul>
<li><p><strong>Menor riesgo de sobreajuste</strong>: Los modelos más simples son menos propensos a ajustarse al ruido presente en los datos, lo que puede conducir a un mejor desempeño en generalización.</p></li>
<li><p><strong>Más interpretables</strong>: Métodos inflexibles, como la regresión lineal, tienden a ser más fáciles de entender e interpretar.</p></li>
</ul>
<p>Pero también tienen las siguientes desventajas:</p>
<ul>
<li><strong>Mayor sesgo</strong>: Un modelo inflexible puede no capturar patrones complejos en los datos, lo que incrementa el error debido al sesgo.</li>
</ul>
</section>
<section id="cuándo-preferir-una-aproximación-flexible-vs-menos-flexible" class="level2">
<h2 class="anchored" data-anchor-id="cuándo-preferir-una-aproximación-flexible-vs-menos-flexible">¿Cuándo preferir una aproximación flexible vs menos flexible?</h2>
<ul>
<li><p>Una aproximación <strong>más flexible</strong> es preferida cuando la relación entre los predictores y la variable respuesta es <strong>compleja y no lineal</strong>, y se cuenta con una <strong>gran cantidad de datos</strong> para mitigar el riesgo de sobreajuste.</p></li>
<li><p>Una aproximación <strong>menos flexible</strong> es preferida cuando se tiene <strong>pocos datos</strong> o cuando la relación entre los predictores y la respuesta es <strong>sencilla</strong> o lineal, lo cual disminuye el riesgo de varianza elevada y sobreajuste.</p></li>
</ul>
</section>
</section>
<section id="ejercicio-4" class="level1">
<h1>Ejercicio 4</h1>
<section id="método-de-vecino-más-cercano-para-clasificación-y-regresión" class="level2">
<h2 class="anchored" data-anchor-id="método-de-vecino-más-cercano-para-clasificación-y-regresión">Método de vecino más cercano para clasificación y regresión</h2>
<section id="clasificación" class="level3">
<h3 class="anchored" data-anchor-id="clasificación">Clasificación</h3>
<p>En el <strong>método de k vecinos más cercanos para clasificación</strong>, dado un punto nuevo de datos <span class="math inline">\(x_0\)</span>, el algoritmo encuentra los <span class="math inline">\(k\)</span> puntos más cercanos a <span class="math inline">\(x_0\)</span> en el conjunto de entrenamiento. La clase asignada a <span class="math inline">\(x_0\)</span> es aquella que aparece con mayor frecuencia entre sus <span class="math inline">\(k\)</span> vecinos más cercanos. Matemáticamente, la clase predicha para <span class="math inline">\(x_0\)</span> se define como:</p>
<p><span class="math display">\[
\hat{y}_0 = \text{mode}\{y_i : x_i \in N_k(x_0)\}
\]</span></p>
<p>donde <span class="math inline">\(N_k(x_0)\)</span> representa el conjunto de los <span class="math inline">\(k\)</span> vecinos más cercanos a <span class="math inline">\(x_0\)</span>, y <span class="math inline">\(y_i\)</span> son las etiquetas de clase correspondientes a esos vecinos.</p>
<section id="ventajas" class="level4">
<h4 class="anchored" data-anchor-id="ventajas">Ventajas:</h4>
<ul>
<li>Simple de implementar.</li>
<li>No asume una forma particular de la función de decisión.</li>
</ul>
</section>
<section id="desventajas" class="level4">
<h4 class="anchored" data-anchor-id="desventajas">Desventajas:</h4>
<ul>
<li>Sensible al valor de <span class="math inline">\(k\)</span>.</li>
<li>Requiere calcular distancias a todos los puntos del conjunto de entrenamiento para cada nueva predicción.</li>
</ul>
</section>
</section>
<section id="regresión" class="level3">
<h3 class="anchored" data-anchor-id="regresión">Regresión</h3>
<p>En el <strong>método de k vecinos más cercanos para regresión</strong>, en lugar de asignar una clase, se estima un valor numérico continuo. Para un nuevo punto <span class="math inline">\(x_0\)</span>, el valor de la variable de respuesta se predice tomando el promedio de los valores de los <span class="math inline">\(k\)</span> vecinos más cercanos en el conjunto de entrenamiento. La predicción para <span class="math inline">\(y_0\)</span> se calcula como:</p>
<p><span class="math display">\[
\hat{y}_0 = \frac{1}{k} \sum_{i \in N_k(x_0)} y_i
\]</span></p>
<p>donde <span class="math inline">\(N_k(x_0)\)</span> representa el conjunto de los <span class="math inline">\(k\)</span> vecinos más cercanos a <span class="math inline">\(x_0\)</span>, y <span class="math inline">\(y_i\)</span> son los valores de la variable de respuesta correspondientes.</p>
</section>
<section id="esperanza-condicional" class="level3">
<h3 class="anchored" data-anchor-id="esperanza-condicional">Esperanza condicional</h3>
<p>Podemos expresar la predicción como una estimación de la <strong>esperanza condicional</strong> de <span class="math inline">\(y_0\)</span> dado <span class="math inline">\(x_0\)</span>, bajo la suposición de que puntos cercanos en el espacio predictor tienen valores de respuesta similares. Formalmente, podemos aproximar la esperanza condicional <span class="math inline">\(E[Y | X = x_0]\)</span> con:</p>
<p><span class="math display">\[
E[Y | X = x_0] \approx \frac{1}{k} \sum_{i \in N_k(x_0)} y_i
\]</span></p>
<p>Esto implica que el valor esperado de <span class="math inline">\(y_0\)</span> dado <span class="math inline">\(x_0\)</span> se estima como el promedio de los valores observados <span class="math inline">\(y_i\)</span> de los vecinos más cercanos.</p>
<section id="ventajas-1" class="level4">
<h4 class="anchored" data-anchor-id="ventajas-1">Ventajas:</h4>
<ul>
<li>No requiere suposiciones paramétricas sobre la relación entre los predictores y la respuesta.</li>
<li>Captura relaciones no lineales entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> si la elección de <span class="math inline">\(k\)</span> es adecuada.</li>
</ul>
</section>
<section id="desventajas-1" class="level4">
<h4 class="anchored" data-anchor-id="desventajas-1">Desventajas:</h4>
<ul>
<li>Sensible al valor de <span class="math inline">\(k\)</span>. Un valor muy pequeño de <span class="math inline">\(k\)</span> puede llevar a sobreajuste (alta varianza), mientras que un valor muy grande puede subestimar la complejidad del modelo (alto sesgo).</li>
<li>Costoso computacionalmente, especialmente en conjuntos de datos grandes, ya que requiere calcular distancias a todos los puntos de entrenamiento.</li>
</ul>
</section>
</section>
<section id="resumen-de-las-diferencias" class="level3">
<h3 class="anchored" data-anchor-id="resumen-de-las-diferencias">Resumen de las diferencias</h3>
<ul>
<li>En <strong>clasificación</strong>, el método asigna una etiqueta de clase basándose en la frecuencia de las clases entre los <span class="math inline">\(k\)</span> vecinos más cercanos.</li>
<li>En <strong>regresión</strong>, el método predice un valor numérico continuo tomando el promedio de los valores de los <span class="math inline">\(k\)</span> vecinos más cercanos, que es una aproximación de la esperanza condicional <span class="math inline">\(E[Y | X = x_0]\)</span>.</li>
</ul>
</section>
</section>
</section>
<section id="ejercicio-5" class="level1">
<h1>Ejercicio 5</h1>
<section id="a-relación-verdadera-lineal-comparación-de-la-suma-de-cuadrados-de-los-residuos-scr-entre-regresión-lineal-y-cúbica-en-el-conjunto-de-entrenamiento" class="level2">
<h2 class="anchored" data-anchor-id="a-relación-verdadera-lineal-comparación-de-la-suma-de-cuadrados-de-los-residuos-scr-entre-regresión-lineal-y-cúbica-en-el-conjunto-de-entrenamiento">a) Relación verdadera lineal: Comparación de la suma de cuadrados de los residuos (SCR) entre regresión lineal y cúbica en el conjunto de entrenamiento</h2>
<p>Si la verdadera relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> es lineal, la <strong>regresión lineal</strong> debería capturar correctamente esa relación, lo que se reflejaría en una suma de cuadrados de los residuos (SCR) baja.</p>
<ul>
<li>La <strong>regresión cúbica</strong> tiene más términos, permitiendo ajustar mejor los datos. Sin embargo, si la relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> es realmente lineal, los coeficientes de los términos cúbicos y cuadráticos pueden ser <strong>cero</strong>:</li>
</ul>
<p><span class="math display">\[
\hat{\beta}_2 = 0 \quad \text{y} \quad \hat{\beta}_3 = 0
\]</span></p>
<p>En este caso, la regresión cúbica se reduciría a la <strong>regresión lineal</strong>, lo que implica que la <strong>SCR</strong> en el conjunto de entrenamiento para ambos modelos sería igual.</p>
<p>Si los términos cúbicos y cuadráticos no son cero, la regresión cúbica puede ajustar mejor los puntos del conjunto de entrenamiento, resultando en una <strong>SCR</strong> más baja que la de la regresión lineal:</p>
<p><span class="math display">\[
\text{SCR}_{\text{cúbica}} \leq \text{SCR}_{\text{lineal}}
\]</span></p>
<p>Por lo tanto, en el conjunto de entrenamiento, la regresión cúbica <strong>siempre</strong> tendrá una SCR igual o menor que la regresión lineal, debido a que puede ajustar tanto la linealidad como términos adicionales si estos no son cero.</p>
</section>
<section id="b-comparación-de-la-scr-entre-regresión-lineal-y-cúbica-en-el-conjunto-de-test" class="level2">
<h2 class="anchored" data-anchor-id="b-comparación-de-la-scr-entre-regresión-lineal-y-cúbica-en-el-conjunto-de-test">b) Comparación de la SCR entre regresión lineal y cúbica en el conjunto de test</h2>
<p>En el conjunto de test, donde el objetivo es evaluar la generalización, si la verdadera relación es lineal, esperamos que la regresión lineal tenga una <strong>SCR</strong> más baja que la regresión cúbica. Esto se debe a que la regresión cúbica probablemente sobreajuste los datos de entrenamiento, capturando el ruido, lo que lleva a un peor rendimiento en nuevos datos:</p>
<p><span class="math display">\[
\text{SCR}_{\text{lineal}} \leq \text{SCR}_{\text{cúbica}}
\]</span></p>
<p>La regresión lineal debería generalizar mejor en el conjunto de test cuando la relación verdadera es lineal.</p>
</section>
<section id="c-relación-verdadera-no-lineal-comparación-de-la-scr-en-el-conjunto-de-entrenamiento" class="level2">
<h2 class="anchored" data-anchor-id="c-relación-verdadera-no-lineal-comparación-de-la-scr-en-el-conjunto-de-entrenamiento">c) Relación verdadera no lineal: Comparación de la SCR en el conjunto de entrenamiento</h2>
<p>Si la verdadera relación entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> es no lineal, pero no sabemos qué tan lejana está de la linealidad, la regresión cúbica debería ajustarse mejor a los datos en el conjunto de entrenamiento, capturando patrones no lineales. En este caso, esperaríamos que la <strong>SCR</strong> de la regresión cúbica sea menor que la de la regresión lineal en el conjunto de entrenamiento:</p>
<p><span class="math display">\[
\text{SCR}_{\text{cúbica}} \leq \text{SCR}_{\text{lineal}}
\]</span></p>
<p>Esto es porque la regresión cúbica tiene mayor flexibilidad y puede adaptarse a la no linealidad presente en los datos de entrenamiento.</p>
</section>
<section id="d-relación-verdadera-no-lineal-comparación-de-la-scr-en-el-conjunto-de-test" class="level2">
<h2 class="anchored" data-anchor-id="d-relación-verdadera-no-lineal-comparación-de-la-scr-en-el-conjunto-de-test">d) Relación verdadera no lineal: Comparación de la SCR en el conjunto de test</h2>
<p>En el conjunto de test, la regresión cúbica puede seguir capturando mejor la verdadera relación no lineal entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, por lo que podría tener una <strong>SCR</strong> más baja que la regresión lineal. Sin embargo, esto depende de qué tan compleja sea la relación verdadera y qué tan bien se ajuste el modelo cúbico a la estructura subyacente. Si la relación es altamente no lineal, esperaríamos que la <strong>SCR</strong> de la regresión cúbica sea menor en el conjunto de test:</p>
<p><span class="math display">\[
\text{SCR}_{\text{cúbica}} \leq \text{SCR}_{\text{lineal}}
\]</span></p>
<p>Pero si la no linealidad es leve o el modelo cúbico sobreajusta, la regresión lineal podría tener un mejor rendimiento en el conjunto de test.</p>
</section>
</section>
<section id="ejercicio-6" class="level1">
<h1>Ejercicio 6</h1>
<p>El objetivo de este ejercicio es calcular el <strong>Error Cuadrático Medio (MSE)</strong> usando validación cruzada con 5 pliegues para un modelo de <strong>regresión lineal simple</strong>. El modelo a ajustar es de la forma:</p>
<p><span class="math display">\[
f(X) = \beta_0 + \beta_1 X
\]</span></p>
<p>El <strong>Error Cuadrático Medio (MSE)</strong> es una medida del error promedio entre los valores observados y los predichos, y se calcula como:</p>
<p><span class="math display">\[
\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
\]</span></p>
<p>Donde: - <span class="math inline">\(n\)</span> es el número de observaciones. - <span class="math inline">\(y_i\)</span> son los valores reales de la variable de respuesta. - <span class="math inline">\(\hat{y}_i\)</span> son los valores predichos por el modelo.</p>
<section id="proceso-de-validación-cruzada-con-5-pliegues" class="level3">
<h3 class="anchored" data-anchor-id="proceso-de-validación-cruzada-con-5-pliegues">Proceso de validación cruzada con 5 pliegues:</h3>
<ol type="1">
<li><p><strong>Dividir los datos</strong>: Los datos se dividen en 5 subconjuntos o “pliegues”. Cada pliegue se utiliza una vez como conjunto de validación, mientras que los otros 4 pliegues se usan para entrenar el modelo.</p></li>
<li><p><strong>Entrenamiento</strong>: Para cada pliegue, se ajusta un modelo de regresión lineal simple en los datos de entrenamiento (los 4 pliegues restantes).</p></li>
<li><p><strong>Predicción</strong>: Se utiliza el modelo ajustado para predecir los valores de <span class="math inline">\(Y\)</span> en el conjunto de validación (el pliegue que se dejó fuera).</p></li>
<li><p><strong>Calcular el MSE</strong>: Para cada pliegue, se calcula el MSE en el conjunto de validación.</p></li>
<li><p><strong>Promediar el MSE</strong>: Al final, se promedian los MSE de los 5 pliegues para obtener el MSE final de validación cruzada.</p></li>
</ol>
</section>
<section id="fórmula-general-para-el-mse-con-validación-cruzada" class="level3">
<h3 class="anchored" data-anchor-id="fórmula-general-para-el-mse-con-validación-cruzada">Fórmula general para el MSE con validación cruzada:</h3>
<p>Si llamamos <span class="math inline">\(MSE_i\)</span> al MSE calculado en el pliegue <span class="math inline">\(i\)</span>, entonces el MSE total de validación cruzada es:</p>
<p><span class="math display">\[
MSE_{CV} = \frac{1}{5} \sum_{i=1}^{5} MSE_i
\]</span></p>
<p>Donde <span class="math inline">\(MSE_i\)</span> es el error cuadrático medio calculado en el <span class="math inline">\(i\)</span>-ésimo pliegue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, predicted) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>((actual <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mse_values <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(folds)) {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  validation_indices <span class="ot">&lt;-</span> folds[[i]]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  training_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>validation_indices, ]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  validation_data <span class="ot">&lt;-</span> data[validation_indices, ]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> training_data)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> validation_data)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  mse_value <span class="ot">&lt;-</span> <span class="fu">mse</span>(validation_data<span class="sc">$</span>Y, predictions)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  mse_values <span class="ot">&lt;-</span> <span class="fu">c</span>(mse_values, mse_value)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>mse_cv <span class="ot">&lt;-</span> <span class="fu">mean</span>(mse_values)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>mse_cv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9323412</code></pre>
</div>
</div>
</section>
</section>
<section id="ejericio-7" class="level1">
<h1>Ejericio 7</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot de X vs Y"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>loocv <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cv.glm</span>(data, model)<span class="sc">$</span>delta[<span class="dv">1</span>])}</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> data)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">data =</span> data)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">4</span>), <span class="at">data =</span> data)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>loocv1 <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model1)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>loocv2 <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model2)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>loocv3 <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model3)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>loocv4 <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>model1_bis <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>model2_bis <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> data)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>model3_bis <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">data =</span> data)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>model4_bis <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">4</span>), <span class="at">data =</span> data)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>loocv1_bis <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model1_bis)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>loocv2_bis <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model2_bis)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>loocv3_bis <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model3_bis)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>loocv4_bis <span class="ot">&lt;-</span> <span class="fu">loocv</span>(model4_bis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">c</span>(loocv1, loocv2, loocv3, loocv4)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(errors) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Modelo 1"</span>, <span class="st">"Modelo 2"</span>, <span class="st">"Modelo 3"</span>, <span class="st">"Modelo 4"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>errors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Modelo 1  Modelo 2  Modelo 3  Modelo 4 
 8.924769 14.659982 14.660680 14.676482 </code></pre>
</div>
</div>
</section>
<section id="ejercico-8" class="level1">
<h1>Ejercico 8</h1>
<section id="ejercicio-1-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-1-1">Ejercicio 1</h2>
</section>
<section id="a-encontrar-un-polinomio-cúbico-f_1x" class="level2">
<h2 class="anchored" data-anchor-id="a-encontrar-un-polinomio-cúbico-f_1x">(a) Encontrar un polinomio cúbico <span class="math inline">\(f_1(x)\)</span></h2>
<p>Cuando <span class="math inline">\(x \leq \xi\)</span>, el término <span class="math inline">\((x - \xi)^3_+\)</span> es igual a cero, por lo que la función <span class="math inline">\(f(x)\)</span> se reduce a:</p>
<p><span class="math display">\[
f_1(x) = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3
\]</span></p>
<p>Por lo tanto, los coeficientes <span class="math inline">\(a_1\)</span>, <span class="math inline">\(b_1\)</span>, <span class="math inline">\(c_1\)</span> y <span class="math inline">\(d_1\)</span> en el polinomio cúbico son:</p>
<p><span class="math display">\[
a_1 = \beta_0, \quad b_1 = \beta_1, \quad c_1 = \beta_2, \quad d_1 = \beta_3
\]</span></p>
</section>
<section id="b-encontrar-un-polinomio-cúbico-f_2x" class="level2">
<h2 class="anchored" data-anchor-id="b-encontrar-un-polinomio-cúbico-f_2x">(b) Encontrar un polinomio cúbico <span class="math inline">\(f_2(x)\)</span></h2>
<p>Cuando <span class="math inline">\(x &gt; \xi\)</span>, el término <span class="math inline">\((x - \xi)^3_+\)</span> es igual a <span class="math inline">\((x - \xi)^3\)</span>, por lo que la función completa se convierte en:</p>
<p><span class="math display">\[
f_2(x) = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 (x - \xi)^3
\]</span></p>
<p>Expandiendo <span class="math inline">\(\beta_4 (x - \xi)^3\)</span>:</p>
<p><span class="math display">\[
\beta_4 (x - \xi)^3 = \beta_4 (x^3 - 3 \xi x^2 + 3 \xi^2 x - \xi^3)
\]</span></p>
<p>Por lo tanto, el polinomio <span class="math inline">\(f_2(x)\)</span> se puede escribir como:</p>
<p><span class="math display">\[
f_2(x) = (\beta_0 - \beta_4 \xi^3) + (\beta_1 + 3 \beta_4 \xi^2)x + (\beta_2 - 3 \beta_4 \xi)x^2 + (\beta_3 + \beta_4)x^3
\]</span></p>
<p>Esto nos da los coeficientes para <span class="math inline">\(f_2(x)\)</span>:</p>
<p><span class="math display">\[
a_2 = \beta_0 - \beta_4 \xi^3, \quad b_2 = \beta_1 + 3 \beta_4 \xi^2, \quad c_2 = \beta_2 - 3 \beta_4 \xi, \quad d_2 = \beta_3 + \beta_4
\]</span></p>
</section>
<section id="c-mostrar-que-f_1xi-f_2xi" class="level2">
<h2 class="anchored" data-anchor-id="c-mostrar-que-f_1xi-f_2xi">(c) Mostrar que <span class="math inline">\(f_1(\xi) = f_2(\xi)\)</span></h2>
<p>Evaluamos <span class="math inline">\(f_1(x)\)</span> y <span class="math inline">\(f_2(x)\)</span> en <span class="math inline">\(x = \xi\)</span>:</p>
<ul>
<li>Para <span class="math inline">\(f_1(\xi)\)</span>:</li>
</ul>
<p><span class="math display">\[
f_1(\xi) = \beta_0 + \beta_1 \xi + \beta_2 \xi^2 + \beta_3 \xi^3
\]</span></p>
<ul>
<li>Para <span class="math inline">\(f_2(\xi)\)</span>:</li>
</ul>
<p><span class="math display">\[
f_2(\xi) = (\beta_0 - \beta_4 \xi^3) + (\beta_1 + 3 \beta_4 \xi^2) \xi + (\beta_2 - 3 \beta_4 \xi) \xi^2 + (\beta_3 + \beta_4) \xi^3
\]</span></p>
<p>Simplificando <span class="math inline">\(f_2(\xi)\)</span>:</p>
<p><span class="math display">\[
f_2(\xi) = \beta_0 + \beta_1 \xi + \beta_2 \xi^2 + \beta_3 \xi^3
\]</span></p>
<p>Por lo tanto, <span class="math inline">\(f_1(\xi) = f_2(\xi)\)</span>, lo que muestra que la función es continua en <span class="math inline">\(x = \xi\)</span>.</p>
</section>
<section id="d-mostrar-que-f_1xi-f_2xi" class="level2">
<h2 class="anchored" data-anchor-id="d-mostrar-que-f_1xi-f_2xi">(d) Mostrar que <span class="math inline">\(f'_1(\xi) = f'_2(\xi)\)</span></h2>
<p>La derivada de <span class="math inline">\(f_1(x)\)</span> es:</p>
<p><span class="math display">\[
f'_1(x) = \beta_1 + 2 \beta_2 x + 3 \beta_3 x^2
\]</span></p>
<p>Evaluando en <span class="math inline">\(x = \xi\)</span>:</p>
<p><span class="math display">\[
f'_1(\xi) = \beta_1 + 2 \beta_2 \xi + 3 \beta_3 \xi^2
\]</span></p>
<p>La derivada de <span class="math inline">\(f_2(x)\)</span> es:</p>
<p><span class="math display">\[
f'_2(x) = b_2 + 2 c_2 x + 3 d_2 x^2
\]</span></p>
<p>Sustituyendo <span class="math inline">\(b_2\)</span>, <span class="math inline">\(c_2\)</span> y <span class="math inline">\(d_2\)</span>:</p>
<p><span class="math display">\[
f'_2(x) = (\beta_1 + 3 \beta_4 \xi^2) + 2 (\beta_2 - 3 \beta_4 \xi)x + 3 (\beta_3 + \beta_4) x^2
\]</span></p>
<p>Evaluando en <span class="math inline">\(x = \xi\)</span>:</p>
<p><span class="math display">\[
f'_2(\xi) = (\beta_1 + 3 \beta_4 \xi^2) + 2 (\beta_2 - 3 \beta_4 \xi)\xi + 3 (\beta_3 + \beta_4) \xi^2
\]</span></p>
<p>Simplificando:</p>
<p><span class="math display">\[
f'_2(\xi) = \beta_1 + 2 \beta_2 \xi + 3 \beta_3 \xi^2
\]</span></p>
<p>Por lo tanto, <span class="math inline">\(f'_1(\xi) = f'_2(\xi)\)</span>, lo que muestra que la primera derivada es continua en <span class="math inline">\(x = \xi\)</span>.</p>
</section>
<section id="e-mostrar-que-f_1xi-f_2xi" class="level2">
<h2 class="anchored" data-anchor-id="e-mostrar-que-f_1xi-f_2xi">(e) Mostrar que <span class="math inline">\(f''_1(\xi) = f''_2(\xi)\)</span></h2>
<p>La segunda derivada de <span class="math inline">\(f_1(x)\)</span> es:</p>
<p><span class="math display">\[
f''_1(x) = 2 \beta_2 + 6 \beta_3 x
\]</span></p>
<p>Evaluando en <span class="math inline">\(x = \xi\)</span>:</p>
<p><span class="math display">\[
f''_1(\xi) = 2 \beta_2 + 6 \beta_3 \xi
\]</span></p>
<p>La segunda derivada de <span class="math inline">\(f_2(x)\)</span> es:</p>
<p><span class="math display">\[
f''_2(x) = 2 c_2 + 6 d_2 x
\]</span></p>
<p>Sustituyendo <span class="math inline">\(c_2\)</span> y <span class="math inline">\(d_2\)</span>:</p>
<p><span class="math display">\[
f''_2(x) = 2 (\beta_2 - 3 \beta_4 \xi) + 6 (\beta_3 + \beta_4) x
\]</span></p>
<p>Evaluando en <span class="math inline">\(x = \xi\)</span>:</p>
<p><span class="math display">\[
f''_2(\xi) = 2 (\beta_2 - 3 \beta_4 \xi) + 6 (\beta_3 + \beta_4) \xi
\]</span></p>
<p>Simplificando:</p>
<p><span class="math display">\[
f''_2(\xi) = 2 \beta_2 + 6 \beta_3 \xi
\]</span></p>
<p>Por lo tanto, <span class="math inline">\(f''_1(\xi) = f''_2(\xi)\)</span>, lo que muestra que la segunda derivada también es continua en <span class="math inline">\(x = \xi\)</span>.</p>
</section>
<section id="ejercicio-2-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-2-1">Ejercicio 2</h2>
<p>Supongamos que una curva <span class="math inline">\(\hat{g}\)</span> se ajusta suavemente a un conjunto de <span class="math inline">\(n\)</span> puntos usando la siguiente fórmula:</p>
<p><span class="math display">\[
\hat{g} = \arg \min_g \left\{ \sum_{i=1}^{n} (y_i - g(x_i))^2 + \lambda \int \left( g^{(m)}(x) \right)^2 \, dx \right\}
\]</span></p>
<p>Donde: - <span class="math inline">\(\sum_{i=1}^{n} (y_i - g(x_i))^2\)</span> es el término de error de ajuste. - <span class="math inline">\(\lambda \int \left( g^{(m)}(x) \right)^2 \, dx\)</span> es el término de suavización, donde <span class="math inline">\(g^{(m)}(x)\)</span> es la derivada <span class="math inline">\(m\)</span>-ésima de <span class="math inline">\(g(x)\)</span>. - <span class="math inline">\(\lambda\)</span> es un parámetro que controla la suavización, y <span class="math inline">\(g^{(0)} = g\)</span>.</p>
</section>
<section id="a-lambda-infty-m-0" class="level2">
<h2 class="anchored" data-anchor-id="a-lambda-infty-m-0">(a) <span class="math inline">\(\lambda = \infty\)</span>, <span class="math inline">\(m = 0\)</span></h2>
<p>Cuando <span class="math inline">\(\lambda = \infty\)</span> y <span class="math inline">\(m = 0\)</span>, el término de suavización es extremadamente grande, lo que significa que se favorece una función muy suave. Como <span class="math inline">\(m = 0\)</span>, no se penaliza ninguna derivada, lo que lleva a una función constante.</p>
<section id="interpretación" class="level4">
<h4 class="anchored" data-anchor-id="interpretación">Interpretación:</h4>
<p>La curva <span class="math inline">\(\hat{g}\)</span> será una <strong>constante</strong>, porque no hay restricciones en su derivada y la penalización por suavización fuerza la función a ser lo más simple posible.</p>
</section>
<section id="gráfico-esperado" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-esperado">Gráfico esperado:</h4>
<p>Una línea horizontal, independiente de los valores de <span class="math inline">\(x\)</span>.</p>
</section>
</section>
<section id="b-lambda-infty-m-1" class="level2">
<h2 class="anchored" data-anchor-id="b-lambda-infty-m-1">(b) <span class="math inline">\(\lambda = \infty\)</span>, <span class="math inline">\(m = 1\)</span></h2>
<p>Cuando <span class="math inline">\(\lambda = \infty\)</span> y <span class="math inline">\(m = 1\)</span>, la penalización está en la primera derivada de la función <span class="math inline">\(g(x)\)</span>, lo que significa que se favorecen funciones con una pendiente constante (una línea recta).</p>
<section id="interpretación-1" class="level4">
<h4 class="anchored" data-anchor-id="interpretación-1">Interpretación:</h4>
<p>La curva <span class="math inline">\(\hat{g}\)</span> será una <strong>línea recta</strong>, ya que minimiza la primera derivada (cero cambios de pendiente).</p>
</section>
<section id="gráfico-esperado-1" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-esperado-1">Gráfico esperado:</h4>
<p>Una línea recta que ajusta los puntos de forma suave.</p>
</section>
</section>
<section id="c-lambda-infty-m-2" class="level2">
<h2 class="anchored" data-anchor-id="c-lambda-infty-m-2">(c) <span class="math inline">\(\lambda = \infty\)</span>, <span class="math inline">\(m = 2\)</span></h2>
<p>Cuando <span class="math inline">\(\lambda = \infty\)</span> y <span class="math inline">\(m = 2\)</span>, la penalización se aplica sobre la segunda derivada de la función, lo que significa que se favorecen curvas con una curvatura constante (una parábola).</p>
<section id="interpretación-2" class="level4">
<h4 class="anchored" data-anchor-id="interpretación-2">Interpretación:</h4>
<p>La curva <span class="math inline">\(\hat{g}\)</span> será una <strong>parábola</strong>, que permite algo de curvatura pero evita cambios bruscos en la misma.</p>
</section>
<section id="gráfico-esperado-2" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-esperado-2">Gráfico esperado:</h4>
<p>Una parábola suave que se ajusta a los puntos.</p>
</section>
</section>
<section id="d-lambda-infty-m-3" class="level2">
<h2 class="anchored" data-anchor-id="d-lambda-infty-m-3">(d) <span class="math inline">\(\lambda = \infty\)</span>, <span class="math inline">\(m = 3\)</span></h2>
<p>Cuando <span class="math inline">\(\lambda = \infty\)</span> y <span class="math inline">\(m = 3\)</span>, se penalizan los cambios en la tercera derivada, lo que favorece curvas que tienen curvatura suave y cambios suaves en la curvatura (una curva cúbica).</p>
<section id="interpretación-3" class="level4">
<h4 class="anchored" data-anchor-id="interpretación-3">Interpretación:</h4>
<p>La curva <span class="math inline">\(\hat{g}\)</span> será una <strong>curva cúbica</strong>, que permite más flexibilidad que una parábola pero con restricciones en los cambios de curvatura.</p>
</section>
<section id="gráfico-esperado-3" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-esperado-3">Gráfico esperado:</h4>
<p>Una curva cúbica que se ajusta a los puntos suavemente, evitando cambios bruscos en la curvatura.</p>
</section>
</section>
<section id="e-lambda-0-m-3" class="level2">
<h2 class="anchored" data-anchor-id="e-lambda-0-m-3">(e) <span class="math inline">\(\lambda = 0\)</span>, <span class="math inline">\(m = 3\)</span></h2>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, no hay penalización por la suavización, lo que significa que la curva ajusta los puntos exactamente.</p>
<section id="interpretación-4" class="level4">
<h4 class="anchored" data-anchor-id="interpretación-4">Interpretación:</h4>
<p>La curva <span class="math inline">\(\hat{g}\)</span> será una <strong>interpolación exacta</strong> de los puntos. Como no hay restricciones, la curva puede ser muy irregular y seguir exactamente los puntos.</p>
</section>
<section id="gráfico-esperado-4" class="level4">
<h4 class="anchored" data-anchor-id="gráfico-esperado-4">Gráfico esperado:</h4>
<p>Una curva que pasa exactamente por cada punto, posiblemente con cambios bruscos entre ellos.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ejercicio-3-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-3-1">Ejercicio 3</h2>
<p>Supongamos que ajustamos una curva usando las funciones base <span class="math inline">\(b_1(X)\)</span> y <span class="math inline">\(b_2(X)\)</span>, y obtenemos los coeficientes estimados <span class="math inline">\(\hat{\beta}_0 = 1\)</span>, <span class="math inline">\(\hat{\beta}_1 = 1\)</span>, y <span class="math inline">\(\hat{\beta}_2 = -2\)</span>. El modelo ajustado es:</p>
<p><span class="math display">\[
Y = \hat{\beta}_0 + \hat{\beta}_1 b_1(X) + \hat{\beta}_2 b_2(X) + \epsilon
\]</span></p>
<p>Sustituyendo los coeficientes estimados, tenemos:</p>
<p><span class="math display">\[
Y = 1 + 1 \cdot b_1(X) + (-2) \cdot b_2(X)
\]</span></p>
<p>Las funciones base son:</p>
<ol type="1">
<li><span class="math inline">\(b_1(X) = X\)</span>, que es una función lineal.</li>
<li><span class="math inline">\(b_2(X) = (X - 1)^2 I(X \geq 1)\)</span>, donde <span class="math inline">\(I(X \geq 1)\)</span> es una función indicadora que toma el valor 1 si <span class="math inline">\(X \geq 1\)</span> y 0 si <span class="math inline">\(X &lt; 1\)</span>.</li>
</ol>
<section id="comportamiento-de-la-curva-estimada" class="level3">
<h3 class="anchored" data-anchor-id="comportamiento-de-la-curva-estimada">Comportamiento de la curva estimada</h3>
<section id="para-x-1" class="level4">
<h4 class="anchored" data-anchor-id="para-x-1">Para <span class="math inline">\(X &lt; 1\)</span>:</h4>
<p>Cuando <span class="math inline">\(X &lt; 1\)</span>, la función indicadora <span class="math inline">\(I(X \geq 1) = 0\)</span>, por lo que <span class="math inline">\(b_2(X) = 0\)</span>. El modelo se reduce a:</p>
<p><span class="math display">\[
Y = 1 + X
\]</span></p>
<p>Esto significa que la curva es una <strong>recta</strong> con pendiente 1 y ordenada al origen 1 en el intervalo <span class="math inline">\(X &lt; 1\)</span>.</p>
</section>
<section id="para-x-geq-1" class="level4">
<h4 class="anchored" data-anchor-id="para-x-geq-1">Para <span class="math inline">\(X \geq 1\)</span>:</h4>
<p>Cuando <span class="math inline">\(X \geq 1\)</span>, la función indicadora <span class="math inline">\(I(X \geq 1) = 1\)</span>, por lo que <span class="math inline">\(b_2(X) = (X - 1)^2\)</span>. El modelo se convierte en:</p>
<p><span class="math display">\[
Y = 1 + X - 2 (X - 1)^2
\]</span></p>
<p>Esto indica que, para <span class="math inline">\(X \geq 1\)</span>, la curva es una <strong>combinación de una función lineal y una parábola cuadrática</strong> con coeficiente negativo para el término cuadrático. La parábola tiene un vértice en <span class="math inline">\(X = 1\)</span>, ya que <span class="math inline">\((X - 1)^2\)</span> es mínima en ese punto.</p>
</section>
</section>
</section>
</section>
<section id="ejercicio-4-1" class="level1">
<h1>Ejercicio 4</h1>
<p>Supongamos que ajustamos una curva usando las funciones base <span class="math inline">\(b_1(X)\)</span> y <span class="math inline">\(b_2(X)\)</span>, y obtenemos los coeficientes estimados <span class="math inline">\(\hat{\beta}_0 = 1\)</span>, <span class="math inline">\(\hat{\beta}_1 = 1\)</span>, y <span class="math inline">\(\hat{\beta}_2 = 3\)</span>. El modelo ajustado es:</p>
<p><span class="math display">\[
Y = \hat{\beta}_0 + \hat{\beta}_1 b_1(X) + \hat{\beta}_2 b_2(X) + \epsilon
\]</span></p>
<p>Sustituyendo los coeficientes estimados, tenemos:</p>
<p><span class="math display">\[
Y = 1 + 1 \cdot b_1(X) + 3 \cdot b_2(X)
\]</span></p>
<p>Las funciones base son:</p>
<ol type="1">
<li><span class="math inline">\(b_1(X) = I(0 \leq X \leq 2) - (X - 1) I(1 \leq X \leq 2)\)</span>, donde <span class="math inline">\(I(A)\)</span> es una función indicadora que toma el valor 1 si <span class="math inline">\(X\)</span> está en el intervalo indicado y 0 en caso contrario.</li>
<li><span class="math inline">\(b_2(X) = (X - 3) I(3 \leq X \leq 4) + I(4 &lt; X \leq 5)\)</span>, que también utiliza funciones indicadoras para definir el comportamiento en diferentes rangos de <span class="math inline">\(X\)</span>.</li>
</ol>
<section id="análisis-de-la-curva-estimada-en-diferentes-intervalos" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-la-curva-estimada-en-diferentes-intervalos">Análisis de la curva estimada en diferentes intervalos</h3>
<section id="para-x-0" class="level4">
<h4 class="anchored" data-anchor-id="para-x-0">Para <span class="math inline">\(X &lt; 0\)</span>:</h4>
<p>Cuando <span class="math inline">\(X &lt; 0\)</span>, ambas funciones indicadoras son 0, por lo que:</p>
<p><span class="math display">\[
b_1(X) = 0, \quad b_2(X) = 0
\]</span></p>
<p>El modelo se reduce a:</p>
<p><span class="math display">\[
Y = 1
\]</span></p>
<p>Esto significa que la curva es una <strong>línea horizontal</strong> con intersección en <span class="math inline">\(Y = 1\)</span> para <span class="math inline">\(X &lt; 0\)</span>.</p>
</section>
<section id="para-0-leq-x-1" class="level4">
<h4 class="anchored" data-anchor-id="para-0-leq-x-1">Para <span class="math inline">\(0 \leq X &lt; 1\)</span>:</h4>
<p>En este rango, <span class="math inline">\(I(0 \leq X \leq 2) = 1\)</span> pero <span class="math inline">\(I(1 \leq X \leq 2) = 0\)</span>, por lo que:</p>
<p><span class="math display">\[
b_1(X) = 1, \quad b_2(X) = 0
\]</span></p>
<p>El modelo se convierte en:</p>
<p><span class="math display">\[
Y = 1 + 1 = 2
\]</span></p>
<p>Esto significa que la curva es una <strong>línea horizontal en</strong> <span class="math inline">\(Y = 2\)</span> para <span class="math inline">\(0 \leq X &lt; 1\)</span>.</p>
</section>
<section id="para-1-leq-x-leq-2" class="level4">
<h4 class="anchored" data-anchor-id="para-1-leq-x-leq-2">Para <span class="math inline">\(1 \leq X \leq 2\)</span>:</h4>
<p>En este rango, tanto <span class="math inline">\(I(0 \leq X \leq 2) = 1\)</span> como <span class="math inline">\(I(1 \leq X \leq 2) = 1\)</span>, por lo que:</p>
<p><span class="math display">\[
b_1(X) = 1 - (X - 1) = 2 - X, \quad b_2(X) = 0
\]</span></p>
<p>El modelo se convierte en:</p>
<p><span class="math display">\[
Y = 1 + (2 - X)
\]</span></p>
<p>Es decir, <span class="math inline">\(Y = 3 - X\)</span>, lo que implica que la curva tiene una <strong>pendiente negativa</strong> en este intervalo. La curva desciende linealmente desde <span class="math inline">\(Y = 2\)</span> en <span class="math inline">\(X = 1\)</span> hasta <span class="math inline">\(Y = 1\)</span> en <span class="math inline">\(X = 2\)</span>.</p>
</section>
<section id="para-2-x-3" class="level4">
<h4 class="anchored" data-anchor-id="para-2-x-3">Para <span class="math inline">\(2 &lt; X &lt; 3\)</span>:</h4>
<p>Cuando <span class="math inline">\(X\)</span> está en este intervalo, tanto <span class="math inline">\(b_1(X) = 0\)</span> como <span class="math inline">\(b_2(X) = 0\)</span>, por lo que:</p>
<p><span class="math display">\[
Y = 1
\]</span></p>
<p>La curva es nuevamente una <strong>línea horizontal en</strong> <span class="math inline">\(Y = 1\)</span> para <span class="math inline">\(2 &lt; X &lt; 3\)</span>.</p>
</section>
<section id="para-3-leq-x-leq-4" class="level4">
<h4 class="anchored" data-anchor-id="para-3-leq-x-leq-4">Para <span class="math inline">\(3 \leq X \leq 4\)</span>:</h4>
<p>En este rango, <span class="math inline">\(b_2(X) = (X - 3)\)</span> y <span class="math inline">\(b_1(X) = 0\)</span>, por lo que:</p>
<p><span class="math display">\[
Y = 1 + 3 (X - 3)
\]</span></p>
<p>Esto significa que la curva tiene una <strong>pendiente positiva</strong> con una pendiente de 3. El modelo es:</p>
<p><span class="math display">\[
Y = 1 + 3(X - 3) = 3X - 8
\]</span></p>
<p>La curva aumenta linealmente desde <span class="math inline">\(Y = 1\)</span> en <span class="math inline">\(X = 3\)</span> hasta <span class="math inline">\(Y = 4\)</span> en <span class="math inline">\(X = 4\)</span>.</p>
</section>
<section id="para-4-x-leq-5" class="level4">
<h4 class="anchored" data-anchor-id="para-4-x-leq-5">Para <span class="math inline">\(4 &lt; X \leq 5\)</span>:</h4>
<p>En este rango, <span class="math inline">\(b_2(X) = 1\)</span>, por lo que:</p>
<p><span class="math display">\[
Y = 1 + 3 \cdot 1 = 4
\]</span></p>
<p>Esto implica que la curva es una <strong>línea horizontal en</strong> <span class="math inline">\(Y = 4\)</span> para <span class="math inline">\(4 &lt; X \leq 5\)</span>.</p>
</section>
<section id="para-x-5" class="level4">
<h4 class="anchored" data-anchor-id="para-x-5">Para <span class="math inline">\(X &gt; 5\)</span>:</h4>
<p>Cuando <span class="math inline">\(X &gt; 5\)</span>, ambas funciones indicadoras son 0, por lo que:</p>
<p><span class="math display">\[
b_1(X) = 0, \quad b_2(X) = 0
\]</span></p>
<p>El modelo se reduce a:</p>
<p><span class="math display">\[
Y = 1
\]</span></p>
<p>La curva es nuevamente una <strong>línea horizontal en</strong> <span class="math inline">\(Y = 1\)</span> para <span class="math inline">\(X &gt; 5\)</span>.</p>
</section>
</section>
<section id="información-relevante" class="level3">
<h3 class="anchored" data-anchor-id="información-relevante">Información relevante:</h3>
<ul>
<li><strong>Intersección en</strong> <span class="math inline">\(Y = 1\)</span>: En <span class="math inline">\(X = 0\)</span>, la curva corta el eje <span class="math inline">\(Y\)</span> en el punto <span class="math inline">\((0, 1)\)</span>.</li>
<li>La curva es una <strong>línea horizontal en</strong> <span class="math inline">\(Y = 2\)</span> para <span class="math inline">\(0 \leq X &lt; 1\)</span>.</li>
<li>La curva <strong>desciende linealmente</strong> desde <span class="math inline">\(Y = 2\)</span> hasta <span class="math inline">\(Y = 1\)</span> en el intervalo <span class="math inline">\(1 \leq X \leq 2\)</span>.</li>
<li>La curva es <strong>horizontal en</strong> <span class="math inline">\(Y = 1\)</span> para <span class="math inline">\(2 &lt; X &lt; 3\)</span>.</li>
<li>La curva <strong>asciende</strong> con una pendiente de 3 en el intervalo <span class="math inline">\(3 \leq X \leq 4\)</span>.</li>
<li>La curva es <strong>horizontal en</strong> <span class="math inline">\(Y = 4\)</span> para <span class="math inline">\(4 &lt; X \leq 5\)</span>.</li>
<li>Finalmente, la curva vuelve a ser <strong>horizontal en</strong> <span class="math inline">\(Y = 1\)</span> para <span class="math inline">\(X &gt; 5\)</span>.</li>
</ul>
</section>
<section id="ejercico-9" class="level2">
<h2 class="anchored" data-anchor-id="ejercico-9">Ejercico 9</h2>
<section id="parte-a" class="level3">
<h3 class="anchored" data-anchor-id="parte-a">Parte a</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>cubic_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_poly</span>(dis, <span class="at">degree =</span> <span class="dv">3</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>cubic_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cubic_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(cubic_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>cubic_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(cubic_workflow, <span class="at">data =</span> Boston)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(cubic_fit) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.5546951</td>
<td style="text-align: right;">0.0027594</td>
<td style="text-align: right;">201.020893</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">dis_poly_1</td>
<td style="text-align: right;">-2.0030959</td>
<td style="text-align: right;">0.0620709</td>
<td style="text-align: right;">-32.271071</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dis_poly_2</td>
<td style="text-align: right;">0.8563300</td>
<td style="text-align: right;">0.0620709</td>
<td style="text-align: right;">13.795987</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">dis_poly_3</td>
<td style="text-align: right;">-0.3180490</td>
<td style="text-align: right;">0.0620709</td>
<td style="text-align: right;">-5.123959</td>
<td style="text-align: right;">4e-07</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Boston <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dis, <span class="at">y =</span> nox)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ajuste Polinomial Cúbico"</span>, <span class="at">x =</span> <span class="st">"dis"</span>, <span class="at">y =</span> <span class="st">"nox"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parte-b" class="level3">
<h3 class="anchored" data-anchor-id="parte-b">Parte b</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>degrees <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fit_and_rss <span class="ot">&lt;-</span> <span class="cf">function</span>(degree) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  poly_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_poly</span>(dis, <span class="at">degree =</span> degree)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  poly_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(poly_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  poly_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(poly_workflow, <span class="at">data =</span> Boston)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="fu">glance</span>(poly_fit) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(statistic)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rss)}</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>rss_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(degrees, fit_and_rss)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Degree =</span> degrees, <span class="at">RSS =</span> rss_values)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Degree, <span class="at">y =</span> RSS)) <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RSS vs Grado Polinomial"</span>, <span class="at">x =</span> <span class="st">"Grado"</span>, <span class="at">y =</span> <span class="st">"RSS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cv_splits <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(Boston, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>cv_fit_and_rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(degree) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  poly_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_poly</span>(dis, <span class="at">degree =</span> degree)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  poly_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(poly_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  cv_results <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    poly_workflow,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    cv_splits,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  rmse_mean <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(cv_results) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"rmse"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(mean)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rmse_mean)}</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>rmse_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(degrees, cv_fit_and_rmse)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Degree =</span> degrees, <span class="at">RMSE =</span> rmse_values)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> Degree, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMSE vs Grado Polinomial"</span>, <span class="at">x =</span> <span class="st">"Grado"</span>, <span class="at">y =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>spline_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_bs</span>(dis, <span class="at">deg_free =</span> <span class="dv">4</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>spline_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(spline_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>spline_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(spline_workflow, <span class="at">data =</span> Boston)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(spline_fit) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.7344739</td>
<td style="text-align: right;">0.0146003</td>
<td style="text-align: right;">50.305518</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">dis_bs_1</td>
<td style="text-align: right;">-0.0580976</td>
<td style="text-align: right;">0.0218591</td>
<td style="text-align: right;">-2.657825</td>
<td style="text-align: right;">0.0081160</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dis_bs_2</td>
<td style="text-align: right;">-0.4635635</td>
<td style="text-align: right;">0.0236559</td>
<td style="text-align: right;">-19.596141</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">dis_bs_3</td>
<td style="text-align: right;">-0.1997882</td>
<td style="text-align: right;">0.0431140</td>
<td style="text-align: right;">-4.633950</td>
<td style="text-align: right;">0.0000046</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dis_bs_4</td>
<td style="text-align: right;">-0.3888095</td>
<td style="text-align: right;">0.0455070</td>
<td style="text-align: right;">-8.543944</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Boston <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dis, <span class="at">y =</span> nox)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">bs</span>(x, <span class="at">df =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ajuste Spline con 4 Grados de Libertad"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dis"</span>, <span class="at">y =</span> <span class="st">"nox"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_spline_and_rss <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  spline_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_bs</span>(dis, <span class="at">deg_free =</span> df)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  spline_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(spline_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  spline_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(spline_workflow, <span class="at">data =</span> Boston)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="fu">glance</span>(spline_fit) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(statistic)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rss)}</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>rss_spline_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, fit_spline_and_rss)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">DF =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">RSS =</span> rss_spline_values)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DF, <span class="at">y =</span> RSS)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RSS vs Grado de Libertad del Spline"</span>, <span class="at">x =</span> <span class="st">"Grado de Libertad"</span>, <span class="at">y =</span> <span class="st">"RSS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cv_fit_spline_and_rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  spline_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(nox <span class="sc">~</span> dis, <span class="at">data =</span> Boston) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_bs</span>(dis, <span class="at">deg_free =</span> df)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  spline_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(spline_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(cubic_model)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  cv_results <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    spline_workflow,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    cv_splits,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  rmse_mean <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(cv_results) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"rmse"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(mean)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rmse_mean)}</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>rmse_spline_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, cv_fit_spline_and_rmse)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">DF =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">RMSE =</span> rmse_spline_values)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DF, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMSE vs Grado de Libertad del Spline"</span>, <span class="at">x =</span> <span class="st">"Grado de Libertad"</span>, <span class="at">y =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ejercico-10" class="level2">
<h2 class="anchored" data-anchor-id="ejercico-10">Ejercico 10</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"College"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(College)), <span class="at">size =</span> <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(College))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> College[train_indices, ]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> College[<span class="sc">-</span>train_indices, ]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> train_data <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Private =</span> <span class="fu">as.numeric</span>(Private <span class="sc">==</span> <span class="st">"Yes"</span>))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>forward_selection <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Outstate <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">nvmax =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"forward"</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>forward_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(forward_selection)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>best_model_size <span class="ot">&lt;-</span> <span class="fu">which.min</span>(forward_summary<span class="sc">$</span>cp)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(forward_selection, best_model_size))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>selected_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)" "Private"     "Apps"        "Accept"      "Top25perc"  
 [6] "F.Undergrad" "Room.Board"  "PhD"         "perc.alumni" "Expend"     
[11] "Grad.Rate"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>selected_predictors <span class="ot">&lt;-</span> selected_vars[selected_vars <span class="sc">!=</span> <span class="st">"(Intercept)"</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Private =</span> <span class="fu">as.numeric</span>(Private <span class="sc">==</span> <span class="st">"Yes"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>final_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Outstate <span class="sc">~</span> ., <span class="at">data =</span> train_data) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(<span class="fu">all_predictors</span>(), <span class="at">new_role =</span> <span class="st">"ignore"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(<span class="fu">all_of</span>(selected_predictors), <span class="at">new_role =</span> <span class="st">"predictor"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>final_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(final_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(final_model)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>cv_splits <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(train_data, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">fit_resamples</span>(</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  final_workflow,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> cv_splits,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(cv_results) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 4%">
<col style="width: 16%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">std_err</th>
<th style="text-align: left;">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">2073.2599160</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">66.0718915</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7521001</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0187358</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">fit</span>(final_workflow, <span class="at">data =</span> train_data)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_fit, <span class="at">new_data =</span> test_data) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(test_data)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(test_predictions, <span class="at">truth =</span> Outstate, <span class="at">estimate =</span> .pred) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">1886.5804639</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7635986</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">1459.0754745</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>